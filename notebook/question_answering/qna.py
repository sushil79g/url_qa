from farm.modeling.adaptive_model import AdaptiveModel
from farm.modeling.tokenization import Tokenizer
from farm.infer import Inferencer
from pprint import pprint
# from IPython.display import clear_output

model_name = "deepset/roberta-base-squad2"
nlp = Inferencer.load(model_name, task_type="question_answering")
ques = """what is mother trees?"""
text = """6 minutes English from BBC learning English. Com 6-minute English from BBC learning English on male how did you spend your free time during the weeks of lockdown repainting living room or doing exercise classes in the kitchen into my family I'm investigating my family tree you know a drawing showing all the relationships between the different members of my family how interesting and how appropriate because trees of the subject of this program not family trees but real living in the pastries well nail this might surprise you but according to some people trees also have families that are mother tree support and help feed child trees according to Suzanne Simard one of the world's leading tree researches should be seen as intelligent they communicate with each other they help each other and as you mentioned Georgina they can even tell family members so a tree can have its own family tree amazing tell me more question the largest trees in a wood or Forest are called mother trees as they're the biggest mother trees usually the longest most connected Roots so my question is this what is the world's largest currently living tree is it a a Baobab Tree be a giant redwood tree or see it's a a tree I see photos of redwood trees in California and the huge so I'll say be a giant redwoods okay Georgina I'm sure you won't be jealous. Cuz it's the easiest ones pronounce will find out the answer at the end of the program now let's get back to spirits up shut Suzanne Simard big idea was the world wide web a way of describing the network of underground roots thinking tree saw the Trees of the same family BBC World Service program we found that the parent trees would favor those ceilings that were of their own kin versus The Strangers that's excluding when you say they favor though and family members you mean they'll send more nutrients to that Offspring than they would to as a stranger tree that's right by the tree send food and nutrients to that own seedlings young plants that have writing from a seat in this way parent trees help their offspring another word for that children or young mother trees can read nice and feed of the Trees of their own kid an old-fashioned word meaning family with the extra nutrients and called when they receive the Rincon extends their own route Network I suck up even more nutrients which in turn increases their own growth some of them into the Giants we see growing in California and other parts of the world amazing with trees behaving and clever ways like it's no wonder Suzanne thinks they have intelligence and listen again as Susan discusses the question of whether trees live with BBC World service's the big idea see if you can hear her opinion alive in the sense of having agency in there Denise instead of being you. I think a lot of people think of trees is just sort of like these sticks the coronavirus recruitment their kind of these in things that don't have agency in their destiny that they don't change behaviors and make decisions but what we're finding is that they do and you know what step back and think trees have evolved over a long long long time we longer than human being Lakeview evolved in communities and they have to grow and survive I think she believes trees are alive and intelligent because she says they have agency I concept meaning having the ability to act and affect your environment even seem to notice future before they die they will not Offspring to stop making new route connections showing that trees have some the signing of that Destiny everything that happens in someone's life and what will happen in the future then we thought Georgina it certainly going to change how I feel about going for a walk in the woods surrounded by all those intelligent chatting to each other I wonder if they have family arguments I would know if he was one of those really gigantic tree search will Georgia you tell me you mean you'll quiz question about the largest living tree I said the largest currently living trait was be a giant redwood not right Georgina but in fact they don't do is see a giant sequoia name is General Sherman he lives in California Forest he's a whopping 83 me just to land measures a massive 33m around the trunk huge Family Tree in Georgina let's recap the vocabulary with use discussing intelligent trees with family tree diagram showing the relationships between family members trees are intelligent enough to communicate with that or offspring these young plants which have grown from seeds are also known as seedlings another word an old-fashioned way of saying family according to Tree Experts Suzanne Simard trees have agency a term describing ability to act and influence your surroundings on the front of the trees make all kinds of decisions about their lives suggest they understand Destiny everything that happens to someone during their life including in the future thank you for the words of English vocabulary remember you can find more topical discussions on our website as well as a whole Forest of English language resources at BBC learning English goodbye for now by English from BBC learning English """
QA_input = [{"questions": [ques],
             "text": text}]
res = nlp.inference_from_dicts(dicts=QA_input)

import os
os.system('cls' if os.name == 'nt' else 'clear')

print("Ques: ", ques)
print("  "*1000)
print("Context: ",text)
print("  "*1000)
# print(res[0]['predictions'][0]['answers'])
for item in res[0]['predictions'][0]['answers']:
    print(item['answer'])